# Rocket ðŸ’« TypeScript

![License](https://img.shields.io/github/license/Kindness-Works/rocket-ts)

**rocket-ts** generates TypeScript interfaces directly from [Rocket](https://rocket.rs) route handlers. Using generated types on your frontend ensures it remains in sync with every ðŸš€ endpoint, enabling you to quickly find errors and add additional safety to your frontend.

Inspired by [TypeShare](https://github.com/1Password/typeshare), it aims to bring kindness to frontend engineers working with Rocket. ðŸ¤—

## Features

* Generates TypeScript interfaces directly from Rocket [routes and handlers](https://rocket.rs/guide/v0.5/overview/#routing)
* Supports exclusion of parameters created via Rocket [request guards](https://rocket.rs/guide/v0.4/requests/#request-guards)
* Flexible command-line interface 
* Fast and efficient generation

## `rocket-ts` in action

Imagine an email service with a `/thread` API endpoint containing various routes, such as `get_thread`:

```rust
#[get("/thread/<kid_or_ticket_mask>", format = "json")]
async fn get_thread(kid_or_ticket_mask: &str, service: AgentService) -> K7Response<Thread> {
    service.get_thread(kid_or_ticket_mask).await.into()
}
```

This and similar routes can be found in [`example-handlers/thread.rs`](/example-handlers/thread.rs). Assume that `AgentService` implements [FromRequest](https://rocket.rs/guide/v0.5/requests/#request-guards), enabling Rocket to create it automatically, so we exclude it during generation: 

```shell
cargo run generate -i example-handlers -e ./example-handlers/exclude.txt
```

```typescript
/*
 * Generated by rocket-ts 0.1.0 ðŸš€ ðŸŒŽ
 */
export interface k7 {
	// thread.rs
	// handler "/thread/<kid_or_ticket_mask>"
	get_thread: (kid_or_ticket_mask:string) => Thread;
	// handler "/debug/thread/<kid>"
	get_thread_debug: (kid:string) => ThreadDebug;
	// handler "/thread/<thread_id>/comments"
	get_thread_comments: (thread_id:number) => Comment[];
	// handler "/thread/<thread_id>/insights"
	get_thread_insights: (thread_id:number) => MessageInsights;
	// handler "/thread/escalate"
	escalate_thread: (ThreadEscalation) => any;
}
```

## Installation

1. Ensure Rust is installed on your system. If not, download and install it from the official Rust website: [Rust Installation Guide](https://www.rust-lang.org/tools/install).

2. Clone this repository:

```bash
git clone https://github.com/Kindness-Works/rocket-ts.git
```

3. Navigate to the project directory:

```bash
cd rocket-ts
```

4. Build the project:

```bash
cargo build --release
```

The binary will be available in the `target/release` directory.

## Usage

To generate TypeScript interfaces, utilize the `generate` subcommand:

```bash
Usage: rocket-ts generate [OPTIONS] --input <INPUT>

Options:
  -i, --input <INPUT>           Input directory or file to parse for interface generation.
  -o, --output <OUTPUT>         Optional output file. STDOUT if not provided.
  -e, --exclude-type <EXCLUDE>  File listing parameters to exclude (e.g., Request Guards).
```

## Example project

Suppose you have a Rocket project structured as follows:

```
my-rocket-project/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.rs
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ users.rs
â”‚   â”‚   â””â”€â”€ posts.rs
â”‚   â””â”€â”€ guards/
â”‚       â””â”€â”€ auth.rs
â””â”€â”€ exclude.txt
```

To generate TypeScript interfaces for the `users` and `posts` modules, excluding parameters specified in `exclude.txt`, run:

```bash
rocket-ts generate -i src/routes -o server-api.ts -e exclude.txt
```

This command generates a `server-api.ts` file containing TypeScript interfaces for each request handler in `users.rs` and `posts.rs`, excluding parameters specified in `exclude.txt` (e.g., the `auth` guard).

---

## Contributing

Contributions are welcomed! Feel free to open an issue or submit a pull request.

## License

This project is licensed under the [MIT License](LICENSE).
